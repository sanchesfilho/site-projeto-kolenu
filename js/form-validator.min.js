//    PLATAFORMA WEB ‚Äì ONG
//    DESENVOLVIDO POR: JAYME SANCHES FILHO
//    INSTITUI√á√ÉO: UNIVERSIDADE CRUZEIRO DO SUL
//    DISCIPLINA: DESENVOLVIMENTO FRONT‚ÄîEND PARA WEB
//    EXPERI√äNCIA PR√ÅTICA ‚Äî ENTREGA 4 (INTERATIVIDADE E FUNCIONALIDADES)
//    DATA: 03/10/2025

// FORM-VALIDATOR.JS: SISTEMA UNIFICADO DE VALIDA√á√ÉO E ENVIO

if("undefined"!=typeof FormValidator)console.log("\uD83D\uDD04 FormValidator j\xe1 carregado - ignorando duplicata");else{class e{constructor(e){this.form=document.getElementById(e),this.fields=this.form.querySelectorAll("input, select, textarea"),this.submitButton=document.getElementById("submit-button"),this.successMessage=document.getElementById("success-message"),this.loadingSpinner=document.getElementById("loading-spinner"),this.init()}init(){this.fields.forEach(e=>{("cpf"===e.id||"telefone"===e.id||"cep"===e.id)&&e.addEventListener("input",e=>this.applyMask(e)),e.addEventListener("input",()=>this.validateField(e)),e.addEventListener("blur",()=>this.validateField(e)),e.addEventListener("focus",()=>this.showFieldHint(e))}),this.form.addEventListener("submit",e=>this.handleSubmit(e)),console.log("‚úÖ SISTEMA DE VALIDA\xc7\xc3O E ENVIO INICIALIZADO")}async handleSubmit(e){e.preventDefault(),console.log("\uD83D\uDD04 Iniciando processo de envio...");let t=!0,a=[];if(this.fields.forEach(e=>{e.required&&!this.validateField(e)&&(t=!1,a.push(e))}),!t)return this.showErrors(a),!1;await this.submitForm()}async submitForm(){this.showLoading(!0);try{await this.submitToBackend(),this.showSuccess()}catch(e){this.showError("Erro ao enviar formul\xe1rio. Tente novamente.")}finally{this.showLoading(!1)}}async submitToBackend(){return new Promise((e,t)=>{setTimeout(()=>{Math.random()>.05?e({success:!0,message:"Formul\xe1rio enviado com sucesso!"}):t(Error("Erro de conex\xe3o"))},2e3)})}showLoading(e){e?(this.loadingSpinner.style.display="block",this.submitButton.disabled=!0,this.submitButton.textContent="Enviando...",this.submitButton.classList.add("button-loading"),console.log("\uD83D\uDD04 Loading spinner ativado")):(this.loadingSpinner.style.display="none",this.submitButton.disabled=!1,this.submitButton.textContent="Enviar meu cadastro",this.submitButton.classList.remove("button-loading"),console.log("‚úÖ Loading spinner desativado"))}showSuccess(){console.log("\uD83C\uDF89 EXIBINDO MENSAGEM DE SUCESSO"),this.form.reset(),console.log("‚úÖ Formul\xe1rio resetado (campos limpos)"),this.fields.forEach(e=>this.clearFieldStatus(e)),console.log("‚úÖ Estados de valida\xe7\xe3o limpos"),console.log("\uD83C\uDF89 FORMUL\xc1RIO ENVIADO COM SUCESSO!"),console.log("\uD83D\uDCCA Dados enviados:",this.collectFormData()),this.showSuccessAlert()}showSuccessAlert(){let e=document.createElement("div");e.className="success-alert-overlay",e.style.cssText=`
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                animation: fadeIn 0.3s ease;
            `;let t=document.createElement("div");t.className="success-alert-box",t.style.cssText=`
                background: #E0EBFF;
                border: 3px solid #0038B8;
                border-radius: 12px;
                padding: 30px;
                max-width: 500px;
                width: 90%;
                text-align: center;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                position: relative;
                animation: slideDown 0.3s ease;
            `;let a=document.createElement("button");a.innerHTML="\xd7",a.style.cssText=`
                position: absolute;
                top: 15px;
                right: 20px;
                background: none;
                border: none;
                font-size: 28px;
                color: #2c3e50;
                cursor: pointer;
                width: 30px;
                height: 30px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.2s ease;
            `,a.addEventListener("mouseover",function(){this.style.background="#0038B8",this.style.color="white"}),a.addEventListener("mouseout",function(){this.style.background="none",this.style.color="#2c3e50"});let i=document.createElement("h3");i.textContent="‚úì CADASTRO ENVIADO COM SUCESSO!",i.style.cssText=`
                color: #001E60;
                margin: 0 0 15px 0;
                font-size: 1.4rem;
                font-weight: bold;
            `;let s=document.createElement("p");s.textContent="Obrigado por se inscrever como volunt\xe1rio no Projeto KOLENU. Entraremos em contato em breve para lhe passar mais informa\xe7\xf5es a respeito da iniciativa que voc\xea escolheu.",s.style.cssText=`
                color: #2c3e50;
                margin: 0;
                line-height: 1.6;
                font-size: 1rem;
            `;let o=document.createElement("button");o.textContent="OK",o.style.cssText=`
                background: #3498db;
                color: white;
                border: none;
                padding: 12px 30px;
                border-radius: 6px;
                font-size: 1rem;
                font-weight: bold;
                cursor: pointer;
                margin-top: 20px;
                transition: all 0.2s ease;
            `,o.addEventListener("mouseover",function(){this.style.background="#0038B8",this.style.transform="translateY(-2px)"}),o.addEventListener("mouseout",function(){this.style.background="#3498db",this.style.transform="translateY(0)"}),t.appendChild(a),t.appendChild(i),t.appendChild(s),t.appendChild(o),e.appendChild(t),document.body.appendChild(e);let n=()=>{e.style.animation="fadeOut 0.3s ease",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300)};a.addEventListener("click",n),o.addEventListener("click",n),e.addEventListener("click",t=>{t.target===e&&n()}),o.focus()}collectFormData(){let e=new FormData(this.form),t={};for(let[a,i]of e.entries())t[a]=i;return t}applyMask(e){let t=e.target,a=t.value.replace(/\D/g,"");switch(t.id){case"cpf":a.length<=11&&(a=(a=(a=(a=a.replace(/(\d{3})(\d)/,"$1.$2")).replace(/(\d{3})\.(\d{3})(\d)/,"$1.$2.$3")).replace(/(\d{3})\.(\d{3})\.(\d{3})(\d)/,"$1.$2.$3-$4")).substring(0,14));break;case"telefone":a.length<=11&&(a=(a=(a=a.replace(/(\d{2})(\d)/,"($1) $2")).length>10?a.replace(/(\(\d{2}\) \d{5})(\d)/,"$1-$2"):a.replace(/(\(\d{2}\) \d{4})(\d)/,"$1-$2")).substring(0,15));break;case"cep":a.length<=8&&(a=(a=a.replace(/(\d{5})(\d)/,"$1-$2")).substring(0,9))}t.value=a}validateField(e){let t=e.value.trim(),a=!0,i="";switch(this.clearFieldStatus(e),e.type){case"text":switch(a=this.validateText(e,t),e.id){case"nome":i="\uD83D\uDC64 Nome deve conter apenas letras e ter entre 2 e 50 caracteres";break;case"rua":i="\uD83C\uDFE0 Rua deve ter pelo menos 2 caracteres";break;case"complemento":i="\uD83D\uDCCD Complemento deve ter pelo menos 2 caracteres";break;case"cidade":i="\uD83C\uDFD9Ô∏è Cidade deve ter apenas letras e pelo menos 2 caracteres";break;default:i="\uD83D\uDCDD Campo deve ter pelo menos 2 caracteres"}break;case"email":a=this.validateEmail(t),i="\uD83D\uDCE7 Formato de e-mail inv\xe1lido (exemplo: usuario@email.com)";break;case"tel":a=this.validatePhone(t),i="\uD83D\uDCDE Formato de telefone inv\xe1lido (formato: (00) 00000-0000)";break;case"date":a=this.validateDate(e,t),i="\uD83D\uDCC5 Data de nascimento inv\xe1lida ou futura"}return"cpf"===e.id&&(a=this.validateCPF(t),i="\uD83D\uDD22 CPF inv\xe1lido (formato: 000.000.000-00)"),"cep"===e.id&&(a=this.validateCEP(t),i="\uD83D\uDCEE CEP inv\xe1lido (formato: 00000-000)"),!a&&t.length>0?this.setFieldInvalid(e,i):a&&t.length>0&&this.setFieldValid(e),a}validateText(e,t){switch(e.id){case"nome":return/^[A-Za-z√Ä-√ø\s\-']{2,50}$/.test(t);case"rua":case"complemento":default:return t.length>=2;case"cidade":return/^[A-Za-z√Ä-√ø\s\-']{2,}$/.test(t)}}validateEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}validatePhone(e){return/^\(\d{2}\)\s\d{4,5}-\d{4}$/.test(e)}validateCPF(e){return 11===(e=e.replace(/\D/g,"")).length}validateCEP(e){return/^\d{5}-\d{3}$/.test(e)}validateDate(e,t){if(!t)return!1;let a=new Date(t),i=new Date;return i.setHours(0,0,0,0),a<=i}setFieldValid(e){e.classList.remove("field-invalid"),e.classList.add("field-valid");let t=e.parentNode.querySelector(".field-message");t&&(t.style.display="none")}setFieldInvalid(e,t){e.classList.remove("field-valid"),e.classList.add("field-invalid");let a=e.parentNode.querySelector(".field-message");a||((a=document.createElement("div")).className="field-message",e.parentNode.appendChild(a)),a.textContent=t,a.style.display="block"}clearFieldStatus(e){e.classList.remove("field-valid","field-invalid");let t=e.parentNode.querySelector(".field-message");t&&(t.style.display="none")}showFieldHint(e){console.log(`üí° Dica para ${e.name}: ${this.getFieldHint(e)}`)}getFieldHint(e){let t={nome:"Digite seu nome completo (apenas letras, 2-50 caracteres)",email:"exemplo@email.com",telefone:"Digite apenas n\xfameros - ser\xe1 formatado automaticamente",cpf:"Digite apenas n\xfameros - ser\xe1 formatado automaticamente",cep:"Digite apenas n\xfameros - ser\xe1 formatado automaticamente",nascimento:"DD/MM/AAAA",rua:"Digite o nome da rua (m\xednimo 2 caracteres)",complemento:"Digite complemento (apto, casa, etc.)",cidade:"Digite o nome da cidade (apenas letras)"};return t[e.name]||t[e.id]||"Preencha este campo corretamente"}showErrors(e){console.log("‚ùå ERROS NO FORMUL\xc1RIO:",e),e.length>0&&(e[0].scrollIntoView({behavior:"smooth",block:"center"}),e[0].focus()),this.showToast("‚ùå Verifique os campos destacados em vermelho")}showError(e){this.showToast(`‚ùå ${e}`);let t=this.form.querySelectorAll(":invalid");t.forEach(e=>{e.scrollIntoView({behavior:"smooth",block:"center"}),e.focus()})}showToast(e){let t=document.createElement("div");t.className="validation-toast",t.textContent=e,t.style.cssText=`
                position: fixed;
                top: 20px;
                right: 20px;
                background: #e74c3c;
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `,document.body.appendChild(t),setTimeout(()=>{t.remove()},4e3)}}window.FormValidator=e}const initializeFormValidator=()=>{if(window.formValidatorInstance)return console.log("\uD83D\uDD04 Validador j\xe1 inicializado - ignorando duplicata"),!0;let e=document.getElementById("form-cadastro");return!!e&&(console.log("\uD83D\uDE80 INICIALIZANDO SISTEMA UNIFICADO DE FORMUL\xc1RIO"),window.formValidatorInstance=new FormValidator("form-cadastro"),!0)};if("loading"===document.readyState)document.addEventListener("DOMContentLoaded",function(){setTimeout(()=>{let e=document.getElementById("form-cadastro");e?(initializeFormValidator(),console.log("‚úÖ Validador inicializado na p\xe1gina de cadastro")):console.log("‚ÑπÔ∏è  Validador n\xe3o requerido nesta p\xe1gina")},300)});else{let t=document.getElementById("form-cadastro");t?(initializeFormValidator(),console.log("‚úÖ Validador inicializado em p\xe1gina carregada")):console.log("‚ÑπÔ∏è  Validador n\xe3o requerido nesta p\xe1gina")}window.addEventListener("hashchange",()=>{setTimeout(()=>{let e=document.getElementById("form-cadastro");e&&!window.formValidatorInstance&&(console.log("\uD83D\uDD04 Inicializando validador na nova rota SPA"),initializeFormValidator())},200)});