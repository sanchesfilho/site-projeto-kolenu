//    PLATAFORMA WEB – ONG
//    DESENVOLVIDO POR: JAYME SANCHES FILHO
//    INSTITUIÇÃO: UNIVERSIDADE CRUZEIRO DO SUL
//    DISCIPLINA: DESENVOLVIMENTO FRONT—END PARA WEB
//    EXPERIÊNCIA PRÁTICA — ENTREGA 4 (VERSIONAMENTO, ACESSIBILIDADE E DEPLOY)
//    DATA: 04/11/2025

// MOBILE-MENU.JS: SISTEMA DE MENU MOBILE OTIMIZADO COM ANIMAÇÕES SUAVES E SUPORTE A MODOS ESCURO E ALTO CONTRASTE

let menuToggle,navMenu,dropdownToggles,isMenuOpen=!1;function inicializarMenuMobile(){menuToggle=document.querySelector(".menu-button"),navMenu=document.querySelector(".nav-menu"),window.innerWidth<768&&menuToggle&&navMenu&&(configurarMenuMobile(),aplicarEstilosMobile())}function configurarMenuMobile(){menuToggle.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),toggleMenu()}),document.addEventListener("click",function(e){let t=navMenu.contains(e.target),n=e.target===menuToggle||menuToggle.contains(e.target);!isMenuOpen||t||n||fecharMenu()}),configurarDropdownsMobile(),window.addEventListener("resize",function(){window.innerWidth>=768?restaurarMenuDesktop():window.innerWidth<768&&aplicarEstilosMobile()}),document.addEventListener("keydown",function(e){"Escape"===e.key&&isMenuOpen&&fecharMenu()})}function configurarDropdownsMobile(){(dropdownToggles=document.querySelectorAll(".dropdown-toggle")).forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();let t=this.parentElement,n=this.nextElementSibling;t.classList.contains("active")?fecharDropdown(t,n):abrirDropdown(t,n)})})}function abrirDropdown(e,t){document.querySelectorAll(".dropdown.active").forEach(t=>{t!==e&&fecharDropdown(t,t.querySelector(".dropdown-menu"))}),e.classList.add("active"),t.style.maxHeight=t.scrollHeight+"px",e.querySelector(".dropdown-toggle").setAttribute("aria-expanded","true");let n=e.querySelector(".mobile-arrow");n&&(n.style.transform="rotate(90deg)")}function fecharDropdown(e,t){e.classList.remove("active"),t.style.maxHeight="0",e.querySelector(".dropdown-toggle").setAttribute("aria-expanded","false");let n=e.querySelector(".mobile-arrow");n&&(n.style.transform="rotate(0deg)")}function toggleMenu(){isMenuOpen?fecharMenu():abrirMenu()}function animarHamburguer(e){let t=menuToggle.querySelectorAll("span");e?(t[0].style.transform="rotate(45deg) translate(6px, 6px)",t[1].style.opacity="0",t[2].style.transform="rotate(-45deg) translate(6px, -6px)"):(t[0].style.transform="none",t[1].style.opacity="1",t[2].style.transform="none")}function abrirMenu(){navMenu.style.display="flex",setTimeout(()=>{navMenu.style.transform="translateX(0)",navMenu.style.opacity="1"},10),animarHamburguer(!0),isMenuOpen=!0,menuToggle.setAttribute("aria-expanded","true"),document.body.style.overflow="hidden",adicionarOverlay(),setTimeout(()=>{let e=navMenu.querySelector("a, .dropdown-toggle");e&&e.focus()},300)}function fecharMenu(){navMenu.style.transform="translateX(-100%)",navMenu.style.opacity="0",setTimeout(()=>{navMenu.style.display="none"},300),animarHamburguer(!1),isMenuOpen=!1,menuToggle.setAttribute("aria-expanded","false"),document.body.style.overflow="",document.querySelectorAll(".dropdown.active").forEach(e=>{fecharDropdown(e,e.querySelector(".dropdown-menu"))}),removerOverlay(),menuToggle.focus()}function adicionarOverlay(){let e=document.createElement("div");e.className="mobile-menu-overlay",e.style.cssText=`
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 998;
        opacity: 0;
        transition: opacity 0.3s ease;
    `,e.addEventListener("click",function(e){e.stopPropagation(),fecharMenu()}),document.body.appendChild(e),setTimeout(()=>{e.style.opacity="1"},10)}function removerOverlay(){let e=document.querySelector(".mobile-menu-overlay");e&&(e.style.opacity="0",setTimeout(()=>{e.parentElement&&e.parentElement.removeChild(e)},300))}function aplicarEstilosMobile(){let e=menuToggle.getBoundingClientRect(),t=e.bottom+window.scrollY,n=.02*window.innerHeight,r=t+n;navMenu&&(navMenu.style.cssText=`
            position: fixed;
            top: ${r}px !important;
            left: 0;
            width: 45% !important;
            height: calc(100vh - ${r}px) !important;
            background: var(--current-nav-bg);
            flex-direction: column;
            justify-content: flex-start;
            align-items: stretch;
            padding: 10px 0 0 0;
            gap: 0;
            transform: translateX(-100%);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1001 !important;
            overflow-y: auto;
            display: none;
            box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);
            border-right: 1px solid var(--current-border);
            border-top: 1px solid var(--current-border);
        `);let o=document.querySelectorAll(".nav-menu > li");o.forEach(e=>{e.style.cssText=`
            width: 100%;
            margin: 0;
            border-bottom: 1px solid var(--current-border);
        `;let t=e.querySelector("a:not(.dropdown-toggle)");t&&(t.style.cssText=`
                display: block;
                padding: var(--space-lg) var(--space-md);
                font-size: var(--text-sm);
                width: 100%;
                min-height: 44px;
                text-decoration: none;
                color: var(--current-text);
                transition: all 0.2s ease;
                display: flex;
                align-items: center;
                cursor: pointer;
            `,t.addEventListener("mouseenter",function(){this.style.backgroundColor="var(--current-background)"}),t.addEventListener("mouseleave",function(){this.style.backgroundColor="transparent"}));let n=e.querySelector(".dropdown-toggle");if(n&&(n.style.cssText=`
                display: flex;
                justify-content: space-between;
                align-items: center;
                width: 100%;
                padding: var(--space-lg) var(--space-md);
                font-size: var(--text-sm);
                min-height: 44px;
                text-decoration: none;
                color: var(--current-text);
                background: none;
                border: none;
                font-family: inherit;
                cursor: pointer;
            `,n.addEventListener("mouseenter",function(){this.style.backgroundColor="var(--current-background)"}),n.addEventListener("mouseleave",function(){this.style.backgroundColor="transparent"}),!n.querySelector(".mobile-arrow"))){let r=document.createElement("span");r.className="mobile-arrow",r.innerHTML="›",r.style.cssText=`
                    font-size: 1.2em;
                    transition: transform 0.3s ease;
                    margin-left: auto;
                `,n.appendChild(r)}let o=e.querySelector(".dropdown-menu");if(o){o.style.cssText=`
                max-height: 0;
                overflow: hidden;
                transition: max-height 0.3s ease;
                background: var(--current-background-alt);
                padding: 0;
            `;let a=o.querySelectorAll("a");a.forEach(e=>{e.style.cssText=`
                    display: block;
                    padding: var(--space-md) var(--space-xl);
                    font-size: var(--text-xs);
                    min-height: 44px;
                    text-decoration: none;
                    color: var(--current-text);
                    border-bottom: 1px solid var(--current-border);
                    transition: all 0.2s ease;
                    display: flex;
                    align-items: center;
                    cursor: pointer;
                `,e.addEventListener("mouseenter",function(){this.style.backgroundColor="var(--current-background)"}),e.addEventListener("mouseleave",function(){this.style.backgroundColor="transparent"})})}}),o.length>0&&(o[o.length-1].style.borderBottom="none")}function restaurarMenuDesktop(){navMenu&&(navMenu.removeAttribute("style"),navMenu.style.display="",isMenuOpen&&fecharMenu()),dropdownToggles&&dropdownToggles.forEach(e=>{e.removeAttribute("style");let t=e.querySelector(".mobile-arrow");t&&t.remove()}),animarHamburguer(!1);let e=document.querySelectorAll(".nav-menu > li");e.forEach(e=>{e.removeAttribute("style");let t=e.querySelector("a");t&&t.removeAttribute("style");let n=e.querySelector(".dropdown-menu");n&&n.removeAttribute("style")}),removerOverlay()}document.addEventListener("DOMContentLoaded",function(){inicializarMenuMobile()}),document.addEventListener("click",function(e){if(window.innerWidth<768&&isMenuOpen){let t=e.target.closest('a[href^="#/"]');if(t&&!t.classList.contains("dropdown-toggle")){e.preventDefault();let n=t.getAttribute("href");fecharMenu(),setTimeout(()=>{window.location.hash=n},300)}}}),window.addEventListener("scroll",function(){if(window.innerWidth<768&&navMenu){let e=menuToggle.getBoundingClientRect(),t=e.bottom+window.scrollY,n=.02*window.innerHeight,r=t+n;navMenu.style.top=`${r}px`,navMenu.style.height=`calc(100vh - ${r}px)`}}),console.log("MOBILE MENU INICIALIZADO - POSICIONADO 2% ABAIXO HAMB\xdaRGUER");